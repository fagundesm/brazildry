#                     "volume_raiz_ocupada"), variable.name = "target", value.name = "rii")
wmk<- read.csv("wmk.csv")
wmk$plot <- as.factor(wmk$plot)
#wmk <- as.matrix(wmk)
##Análise glmm plot as Fixed factor - Pergunta 2
wmkst <- wmk[,-c(1,2,12)]
wmkst <- scale(wmkst, center=T, scale=T) # o R sugeriu reescalonar as variáveis preditodas porque elas estão em escalas muito diferentes
wmkst <- cbind(wmkst, wmk[,c(1,2,12)])
quest2 <- lmer(rii ~ dh:rsprop + meses_s_fol:rsprop +  d13C:rsprop  +  diam_medio_copa:rsprop +  volume_raiz_ocupada:rsprop + CN:rsprop + SLA:rsprop+  dh:sensdrought + meses_s_fol:sensdrought +  d13C:sensdrought  +  diam_medio_copa:sensdrought +  volume_raiz_ocupada:sensdrought+ CN:sensdrought+ SLA:sensdrought+ meses_s_fol:d13C:rsprop + volume_raiz_ocupada:meses_s_fol:rsprop + CN:d13C:rsprop + diam_medio_copa:meses_s_fol:rsprop  + meses_s_fol:d13C:sensdrought  + volume_raiz_ocupada:meses_s_fol:sensdrought  + CN:d13C:sensdrought + diam_medio_copa : meses_s_fol:sensdrought + (1|plot),  data=wmkst)
summary(quest2)
q2<- update(quest2,. ~ . -rsprop:d13C:CN )
anova(quest2, q2, test="Chisq")
summary(q2)
q3<- update(q2,. ~ . -rsprop:meses_s_fol:d13C )
anova(q3, q2, test="Chisq")
summary(q3)
q4<- update(q3,. ~ . -meses_s_fol:d13C:sensdrought )
anova(q3, q4, test="Chisq")
summary(q4)
q5<- update(q4,. ~ . -rsprop:meses_s_fol:volume_raiz_ocupada )
anova(q5, q4, test="Chisq")
summary(q5)
q6<- update(q5,. ~ . -meses_s_fol:diam_medio_copa:sensdrought )
anova(q5, q6, test="Chisq")
summary(q6)
q7<- update(q6,. ~ . -rsprop:meses_s_fol:diam_medio_copa)
anova(q7, q6, test="Chisq")
summary(q7)
q8<- update(q7,. ~ . -meses_s_fol:volume_raiz_ocupada:sensdrought)
anova(q7, q8, test="Chisq")
summary(q8)
q9<- update(q8,. ~ . -d13C:CN:sensdrought)
anova(q9, q8, test="Chisq")
summary(q9)
q10<- update(q9,. ~ . -SLA:sensdrought)
anova(q9, q10, test="Chisq")
summary(q10)
q11<- update(q10,. ~ . -rsprop:meses_s_fol)
anova(q11, q10, test="Chisq")
summary(q11)
q12<- update(q11,. ~ . -dh:sensdrought)
anova(q11, q12, test="Chisq")
summary(q12)
q13<- update(q12,. ~ . -sensdrought:meses_s_fol)
anova(q13, q12, test="Chisq")
summary(q13)
q14<- update(q13,. ~ . -rsprop:diam_medio_copa)
anova(q13, q14, test="Chisq")
summary(q14)
q15<- update(q14,. ~ . -sensdrought:diam_medio_copa)
anova(q15, q14, test="Chisq")
summary(q15)
q16<- update(q15,. ~ . -CN:sensdrought)
anova(q15, q16, test="Chisq")
summary(q16)
q17<- update(q16,. ~ . -volume_raiz_ocupada:sensdrought)
anova(q17, q16, test="Chisq")
summary(q17)
r.squaredGLMM(q17)
setwd("~/Dropbox/Experiment_interaction/R/paper_traits")
#Question2: Como a interação de atributos nurse-target influenciam seus outcomes?
#traits nurses e rii
#library(reshape2)
#wmk<- wmknurse[,c(1,2,14,23,28,30,31,35,36,37,39,40,41,42)]
#wmk <- melt(wmk, id.vars= c("plot", "spnurse", "dens_mad", "das_m","diam_medio_copa","dh","d13C","CN","SLA","meses_s_fol",
#                     "volume_raiz_ocupada"), variable.name = "target", value.name = "rii")
wmk<- read.csv("wmk.csv")
wmk$plot <- as.factor(wmk$plot)
wmkst <- wmk[,-c(1,2,12)]
wmkst <- scale(wmkst, center=T, scale=T) # o R sugeriu reescalonar as variáveis preditodas porque elas estão em escalas muito diferentes
wmkst <- cbind(wmkst, wmk[,c(1,2,12)])
quest2 <- lmer(rii ~ dh:rsprop + meses_s_fol:rsprop +  d13C:rsprop  +  diam_medio_copa:rsprop +  volume_raiz_ocupada:rsprop + CN:rsprop + SLA:rsprop+  dh:sensdrought + meses_s_fol:sensdrought +  d13C:sensdrought  +  diam_medio_copa:sensdrought +  volume_raiz_ocupada:sensdrought+ CN:sensdrought+ SLA:sensdrought+ meses_s_fol:d13C:rsprop + volume_raiz_ocupada:meses_s_fol:rsprop + CN:d13C:rsprop + diam_medio_copa:meses_s_fol:rsprop  + meses_s_fol:d13C:sensdrought  + volume_raiz_ocupada:meses_s_fol:sensdrought  + CN:d13C:sensdrought + diam_medio_copa : meses_s_fol:sensdrought + (1|plot),  data=wmkst)
summary(quest2)
q2<- update(quest2,. ~ . -rsprop:d13C:CN )
anova(quest2, q2, test="Chisq")
summary(q2)
q3<- update(q2,. ~ . -rsprop:meses_s_fol:d13C )
anova(q3, q2, test="Chisq")
summary(q3)
library(lme4)
quest2 <- lmer(rii ~ dh:rsprop + meses_s_fol:rsprop +  d13C:rsprop  +  diam_medio_copa:rsprop +  volume_raiz_ocupada:rsprop + CN:rsprop + SLA:rsprop+  dh:sensdrought + meses_s_fol:sensdrought +  d13C:sensdrought  +  diam_medio_copa:sensdrought +  volume_raiz_ocupada:sensdrought+ CN:sensdrought+ SLA:sensdrought+ meses_s_fol:d13C:rsprop + volume_raiz_ocupada:meses_s_fol:rsprop + CN:d13C:rsprop + diam_medio_copa:meses_s_fol:rsprop  + meses_s_fol:d13C:sensdrought  + volume_raiz_ocupada:meses_s_fol:sensdrought  + CN:d13C:sensdrought + diam_medio_copa : meses_s_fol:sensdrought + (1|plot),  data=wmkst)
summary(quest2)
q2<- update(quest2,. ~ . -rsprop:d13C:CN )
anova(quest2, q2, test="Chisq")
summary(q2)
q3<- update(q2,. ~ . -rsprop:meses_s_fol:d13C )
anova(q3, q2, test="Chisq")
summary(q3)
q4<- update(q3,. ~ . -meses_s_fol:d13C:sensdrought )
anova(q3, q4, test="Chisq")
summary(q4)
q5<- update(q4,. ~ . -rsprop:meses_s_fol:volume_raiz_ocupada )
anova(q5, q4, test="Chisq")
summary(q5)
q6<- update(q5,. ~ . -meses_s_fol:diam_medio_copa:sensdrought )
anova(q5, q6, test="Chisq")
summary(q6)
q7<- update(q6,. ~ . -rsprop:meses_s_fol:diam_medio_copa)
anova(q7, q6, test="Chisq")
summary(q7)
q8<- update(q7,. ~ . -meses_s_fol:volume_raiz_ocupada:sensdrought)
anova(q7, q8, test="Chisq")
summary(q8)
q9<- update(q8,. ~ . -d13C:CN:sensdrought)
anova(q9, q8, test="Chisq")
summary(q9)
q10<- update(q9,. ~ . -SLA:sensdrought)
anova(q9, q10, test="Chisq")
summary(q10)
q11<- update(q10,. ~ . -rsprop:meses_s_fol)
anova(q11, q10, test="Chisq")
summary(q11)
q12<- update(q11,. ~ . -dh:sensdrought)
anova(q11, q12, test="Chisq")
summary(q12)
q13<- update(q12,. ~ . -sensdrought:meses_s_fol)
anova(q13, q12, test="Chisq")
summary(q13)
q14<- update(q13,. ~ . -rsprop:diam_medio_copa)
anova(q13, q14, test="Chisq")
summary(q14)
q15<- update(q14,. ~ . -sensdrought:diam_medio_copa)
anova(q15, q14, test="Chisq")
summary(q15)
q16<- update(q15,. ~ . -CN:sensdrought)
anova(q15, q16, test="Chisq")
summary(q16)
q17<- update(q16,. ~ . -volume_raiz_ocupada:sensdrought)
anova(q17, q16, test="Chisq")
summary(q17)
r.squaredGLMM(q17)
anova(q17, q16, test="Chisq")
summary(q17)
library(car)
crPlots(q17)
